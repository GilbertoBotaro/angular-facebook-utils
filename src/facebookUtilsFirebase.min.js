!function(a,b){"use strict";b["true"]=a;var c={firebaseURL:"",appID:"",permissions:"",channelFile:"bower_components/angular-facebook-utils/channel.html",routingEnabled:!1,loginPath:"/"};angular.module("facebookUtils",["firebase"]).constant("facebookConfigDefaults",c).value("facebookConfigSettings",c).run(["facebookConfigSettings","facebookConfigDefaults","$rootScope","$location","facebookSDK","angularFireCollection","$route",function(a,b,c,d,e,f,g){for(var h in b)void 0===a[h]&&(a[h]=b[h]);a.appID?e.initializeFb(a.appID):a.firebaseURL?f(new Firebase(a.firebaseURL),function(a){var b=a.val();b&&b.appId?e.initializeFb(b.appId):e.cantInitialize=!0}):e.cantInitialize=!0,a.routingEnabled&&(c.$on("$routeChangeStart",function(b,c){c&&c.$$route&&c.$$route.needAuth&&e.getInitializedPromise().then(function(){e.loggedIn||d.path(a.loginPath)})}),c.$on("fbLogoutSuccess",function(){g.current.$$route.needAuth&&d.path(a.loginPath)}))}]),angular.module("facebookUtils").run(["$templateCache",function(a){a.put("src/views/facebookLoginPartialFirebase.html",'<div id=facebookLogin><style>.marginTop {margin-top: 10px;}\n    .modal.show {display: block;}\n    .btn-auth,.btn-auth:visited{position:relative;display:inline-block;height:22px;padding:0 1em;border:1px solid #999;border-radius:2px;margin:0;text-align:center;text-decoration:none;font-size:14px;line-height:22px;white-space:nowrap;cursor:pointer;color:#222;background:#fff;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-appearance:none;*overflow:visible;*display:inline;*zoom:1}.btn-auth:hover,.btn-auth:focus,.btn-auth:active{color:#222;text-decoration:none}.btn-auth:before{content:"";float:left;width:22px;height:22px;background:url(http://necolas.github.io/css3-social-signin-buttons/auth-icons.png) no-repeat 99px 99px}.btn-auth.large{height:36px;line-height:36px;font-size:20px}.btn-auth.large:before{width:36px;height:36px}.btn-auth::-moz-focus-inner{border:0;padding:0}.btn-facebook,.btn-facebook:visited{border-color:#29447e;border-bottom-color:#1a356e;color:#fff;background-color:#5872a7;background-image:-webkit-gradient(linear,0 0,0 100%,from(#637bad),to(#5872a7));background-image:-webkit-linear-gradient(#637bad,#5872a7);background-image:-moz-linear-gradient(#637bad,#5872a7);background-image:-ms-linear-gradient(#637bad,#5872a7);background-image:-o-linear-gradient(#637bad,#5872a7);background-image:linear-gradient(#637bad,#5872a7);-webkit-box-shadow:inset 0 1px 0 #879ac0;box-shadow:inset 0 1px 0 #879ac0}.btn-facebook:hover,.btn-facebook:focus{color:#fff;background-color:#3b5998}.btn-facebook:active{color:#fff;background:#4f6aa3;-webkit-box-shadow:inset 0 1px 0 #45619d;box-shadow:inset 0 1px 0 #45619d}.btn-facebook:before{border-right:1px solid #465f94;margin:0 1em 0 -1em;background-position:0 0}.btn-facebook.large:before{background-position:0 -22px}</style><a ng-click=signInOrConfigure() data-toggle=modal data-target=#myModal class="btn-auth btn-facebook"><span ng-hide=connectedToFB>Sign in with <b>Facebook</b></span> <span ng-show=connectedToFB>Sign out</span></a> <div class=modal ng-class="{fade: !showConfigure, show: showConfigure}"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close ng-click="showConfigure = false">&times;</button><h4 class=modal-title>Configure Facebook Login</h4></div><div class=modal-body><div>First, you\'ll need to register your app on Facebook. Follow these steps:</div><ol class=marginTop><li>Visit <a href=https://developers.facebook.com/apps target=_blank>https://developers.facebook.com/apps</a></li><li>Create New App (Only a name is required.)</li><li>Set "Sandbox Mode" to "Disabled"</li><li>Under "Select how your app integrates with Facebook", expand "Website with Facebook Login".</li><li>Set Site URL to: <span ng-bind=configureLocation>http://localhost:3000/</span></li></ol><div>Now, copy over some details.</div><form role=form class=marginTop><div class=form-group><label for=appIdInput>Facebook App ID:</label><input id=appIdInput ng-model=newAppId class=form-control placeholder="App ID"></div></form></div><div class=modal-footer><button type=button class="btn btn-default" ng-click="showConfigure = false">I\'ll do this later</button> <button ng-hide=reloading type=button ng-click=saveConfiguration() class="btn btn-primary">Save configuration</button> <button ng-show=reloading type=button class="btn btn-primary">Reloading...</button></div></div></div></div><div id=fb-root></div></div>')}]),angular.module("facebookUtils").service("facebookSDK",["$window","$rootScope","$q","facebookConfigSettings",function(a,b,c,d){var e=function(){};return e.permissions=d.permissions,e.channelFile=d.channelFile,e.initialized=!1,e.loggedIn=!1,e.cantInitialize=!1,e.prototype.getInitializedPromise=function(){var a=c.defer(),b=this,d=function(){b.initialized?a.resolve():b.cantInitialize?a.reject():setTimeout(d,50)};return d(),a.promise},e.prototype.api=function(){var a=c.defer(),d=[].splice.call(arguments,0);return d.push(function(c){b.$apply(function(){a.resolve(c)})}),FB.api.apply(FB,d),a.promise},e.prototype.checkStatus=function(){var a=this,d=c.defer();return FB.getLoginStatus(function(c){b.$apply(function(){"connected"===c.status?(a.loggedIn=!0,d.resolve(c)):(a.loggedIn=!1,d.reject(c))})},!0),d.promise},e.prototype.login=function(){var a=this;a.checkStatus().then(function(c){b.$broadcast("fbLoginSuccess",c),a.loggedIn=!0},function(){FB.login(function(c){c.authResponse?(c.userNotAuthorized=!0,b.$broadcast("fbLoginSuccess",c),a.loggedIn=!0):(b.$broadcast("fbLoginFailure"),a.loggedIn=!1)},{scope:a.permissions})})},e.prototype.logout=function(){var a=this;FB.logout(function(c){c?(b.$broadcast("fbLogoutSuccess"),a.loggedIn=!1):b.$broadcast("fbLogoutFailure")})},e.prototype.initializeFb=function(c){var e=this;if(!c&&!d.appID)throw new Error("You must provide an app-id for the facebook-login directive to work!");a.fbAsyncInit=function(){FB.init({appId:c||d.appID,channelUrl:e.channelFile,status:!0,cookie:!0}),FB.Event.subscribe("auth.authResponseChange",function(a){b.$broadcast("fbStatusChange",a)}),e.initialized=!0,e.checkStatus().then(function(a){b.$broadcast("fbLoginSuccess",a),e.loggedIn=!0})},function(a){var b,c="facebook-jssdk",d=a.getElementsByTagName("script")[0];a.getElementById(c)||(b=a.createElement("script"),b.id=c,b.async=!0,b.src="//connect.facebook.net/en_US/all.js",d.parentNode.insertBefore(b,d))}(document)},new e}]),angular.module("facebookUtils").directive("facebookLogin",["$rootScope","angularFire","facebookSDK","facebookConfigSettings",function(a,b,c,d){return{templateUrl:"src/views/facebookLoginPartialFirebase.html",restrict:"E",replace:!0,scope:!1,link:function(e,f,g){var h=g.showConfigure||c.cantInitialize;if(e.signInOrConfigure=function(){return a.connectedToFB?(c.logout(),void 0):(h?(e.configureLocation=window.location.origin,e.showConfigure=!0):a.connectedToFB?c.logout():c.login(),void 0)},e.$on("fbLoginSuccess",function(){a.connectedToFB=!0}),e.$on("fbLogoutSuccess",function(){e.$apply(function(){a.connectedToFB=!1})}),h){var i=d.firebaseURL;if(!i)throw new Error("You'll need to either specify a Firebase URL or App ID via application value");var j=new Firebase(i);e.facebook={appId:""},b(j,e,"facebook"),e.$watch("facebook",function(){e.newAppId=e.facebook.appId},!0),e.saveConfiguration=function(){if(e.newAppId){var b=e.facebook.appId;e.newAppId===b?(a.connectedToFB?c.logout():c.login(),e.showConfigure=!1):(e.reloading=!0,e.facebook.appId=e.newAppId,setTimeout(function(){location.reload()},1e3))}}}}}}])}({},function(){return this}());